<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë Œë”ë§ ì„¤ì • - Shadowing Maker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            margin-bottom: 30px;
            color: #2c3e50;
            text-align: center;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
        }
        
        .settings-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .settings-section h2 {
            color: #3498db;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        
        input[type="number"],
        input[type="text"],
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input[type="number"]:focus,
        input[type="text"]:focus,
        select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        
        .range-value {
            text-align: center;
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .color-input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        input[type="color"] {
            width: 50px;
            height: 40px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            justify-content: center;
        }
        
        button {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-save {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-save:hover {
            background-color: #229954;
        }
        
        .btn-reset {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-reset:hover {
            background-color: #c0392b;
        }
        
        .btn-load {
            background-color: #3498db;
            color: white;
        }
        
        .btn-load:hover {
            background-color: #2980b9;
        }
        
        .message {
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            text-align: center;
            display: none;
        }
        
        .message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ë Œë”ë§ ì„¤ì •</h1>
        
        <div class="message" id="message"></div>
        
        <div class="settings-grid">
            <!-- TTS ì„¤ì • -->
            <div class="settings-section">
                <h2>ğŸ¤ TTS ì„¤ì •</h2>
                
                <div class="form-group">
                    <label for="voice_korean">í•œêµ­ì–´ ìŒì„±</label>
                    <select id="voice_korean" name="voice_korean">
                        <option value="ko-KR-SunHiNeural">Sun-Hi (ì—¬ì„±)</option>
                        <option value="ko-KR-InJoonNeural">InJoon (ë‚¨ì„±)</option>
                        <option value="ko-KR-BongJinNeural">BongJin (ë‚¨ì„±)</option>
                        <option value="ko-KR-JiMinNeural">JiMin (ì—¬ì„±)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="voice_english">ì˜ì–´ ìŒì„±</label>
                    <select id="voice_english" name="voice_english">
                        <option value="en-US-AriaNeural">Aria (ì—¬ì„±)</option>
                        <option value="en-US-JennyNeural">Jenny (ì—¬ì„±)</option>
                        <option value="en-US-GuyNeural">Guy (ë‚¨ì„±)</option>
                        <option value="en-US-EricNeural">Eric (ë‚¨ì„±)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="tts_speed">ì†ë„ ì¡°ì ˆ: <span id="speed_value">0%</span></label>
                    <input type="range" id="tts_speed" min="-50" max="50" value="0">
                </div>
                
                <div class="form-group">
                    <label for="tts_pitch">í”¼ì¹˜ ì¡°ì ˆ: <span id="pitch_value">0Hz</span></label>
                    <input type="range" id="tts_pitch" min="-50" max="50" value="0">
                </div>
                
                <div class="form-group">
                    <label for="tts_volume">ë³¼ë¥¨: <span id="volume_value">100%</span></label>
                    <input type="range" id="tts_volume" min="0" max="100" value="100">
                </div>
            </div>
            
            <!-- ë¹„ë””ì˜¤ ì¸ì½”ë”© ì„¤ì • -->
            <div class="settings-section">
                <h2>ğŸ¥ ë¹„ë””ì˜¤ ì¸ì½”ë”© ì„¤ì •</h2>
                
                <div class="form-group">
                    <label for="video_crf">í’ˆì§ˆ (CRF)</label>
                    <input type="number" id="video_crf" min="16" max="28" value="16">
                    <small style="color: #666;">ë‚®ì„ìˆ˜ë¡ ê³ í’ˆì§ˆ (16-28)</small>
                </div>
                
                <div class="form-group">
                    <label for="video_preset">ì¸ì½”ë”© ì†ë„</label>
                    <select id="video_preset" name="video_preset">
                        <option value="ultrafast">ì´ˆê³ ì† (í’ˆì§ˆ ë‚®ìŒ)</option>
                        <option value="fast">ë¹ ë¦„</option>
                        <option value="medium" selected>ë³´í†µ (ê¶Œì¥)</option>
                        <option value="slow">ëŠë¦¼ (í’ˆì§ˆ ë†’ìŒ)</option>
                        <option value="veryslow">ë§¤ìš° ëŠë¦¼ (ìµœê³  í’ˆì§ˆ)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="video_resolution">í•´ìƒë„</label>
                    <select id="video_resolution" name="video_resolution">
                        <option value="original">ì›ë³¸</option>
                        <option value="720p">720p</option>
                        <option value="1080p">1080p</option>
                        <option value="4k">4K</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="video_framerate">í”„ë ˆì„ë ˆì´íŠ¸</label>
                    <select id="video_framerate" name="video_framerate">
                        <option value="24">24 fps</option>
                        <option value="30" selected>30 fps</option>
                        <option value="60">60 fps</option>
                    </select>
                </div>
            </div>
            
            <!-- ìë§‰ ìŠ¤íƒ€ì¼ ì„¤ì • -->
            <div class="settings-section">
                <h2>ğŸ“ ìë§‰ ìŠ¤íƒ€ì¼ ì„¤ì •</h2>
                
                <div class="form-group">
                    <label for="subtitle_font_english">ì˜ì–´ ìë§‰ í°íŠ¸</label>
                    <select id="subtitle_font_english" name="subtitle_font_english">
                        <option value="Noto Sans CJK KR">Noto Sans CJK KR</option>
                        <option value="NanumGothic">ë‚˜ëˆ”ê³ ë”•</option>
                        <option value="Malgun Gothic">ë§‘ì€ ê³ ë”•</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="subtitle_size_english">ì˜ì–´ ìë§‰ í¬ê¸°</label>
                    <input type="number" id="subtitle_size_english" min="20" max="100" value="60">
                </div>
                
                <div class="form-group">
                    <label for="subtitle_color_english">ì˜ì–´ ìë§‰ ìƒ‰ìƒ</label>
                    <div class="color-input-wrapper">
                        <input type="color" id="subtitle_color_english" value="#FFFFFF">
                        <input type="text" id="subtitle_color_english_text" value="#FFFFFF" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="subtitle_size_korean">í•œê¸€ ìë§‰ í¬ê¸°</label>
                    <input type="number" id="subtitle_size_korean" min="20" max="100" value="50">
                </div>
                
                <div class="form-group">
                    <label for="subtitle_color_korean">í•œê¸€ ìë§‰ ìƒ‰ìƒ</label>
                    <div class="color-input-wrapper">
                        <input type="color" id="subtitle_color_korean" value="#FFD700">
                        <input type="text" id="subtitle_color_korean_text" value="#FFD700" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="subtitle_border_width">í…Œë‘ë¦¬ ë‘ê»˜</label>
                    <input type="number" id="subtitle_border_width" min="0" max="10" value="3">
                </div>
            </div>
            
            <!-- í…œí”Œë¦¿ ì„¤ì • -->
            <div class="settings-section">
                <h2>ğŸ¨ í…œí”Œë¦¿ ì„¤ì •</h2>
                
                <div class="form-group">
                    <label for="gap_duration">í´ë¦½ ê°„ê²© (ì´ˆ)</label>
                    <input type="number" id="gap_duration" min="0" max="5" step="0.5" value="1.5">
                </div>
                
                <div class="form-group checkbox-wrapper">
                    <input type="checkbox" id="fade_effect">
                    <label for="fade_effect">í˜ì´ë“œ íš¨ê³¼</label>
                </div>
                
                <div class="form-group checkbox-wrapper">
                    <input type="checkbox" id="show_title" checked>
                    <label for="show_title">ì œëª© í‘œì‹œ</label>
                </div>
                
                <div class="form-group">
                    <label for="bg_music_volume">ë°°ê²½ìŒì•… ë³¼ë¥¨: <span id="bg_music_value">20%</span></label>
                    <input type="range" id="bg_music_volume" min="0" max="100" value="20">
                </div>
            </div>
            
            <!-- ì‡¼ì¸  ì„¤ì • -->
            <div class="settings-section">
                <h2>ğŸ“± ì‡¼ì¸  ì „ìš© ì„¤ì •</h2>
                
                <div class="form-group">
                    <label for="shorts_aspect_ratio">í¬ë¡­ ë°©ì‹</label>
                    <select id="shorts_aspect_ratio" name="shorts_aspect_ratio">
                        <option value="center">ì¤‘ì•™ í¬ë¡­</option>
                        <option value="origin">ì›ë³¸ ë¹„ìœ¨</option>
                        <option value="top">ìƒë‹¨ ê¸°ì¤€</option>
                        <option value="bottom">í•˜ë‹¨ ê¸°ì¤€</option>
                        <option value="face">ì–¼êµ´ ì¸ì‹</option>
                        <option value="zoom">80% í™•ëŒ€</option>
                        <option value="wide">ì™€ì´ë“œ í¬ë¡­</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="thumbnail_darken">ì¸ë„¤ì¼ ì–´ë‘¡ê²Œ: <span id="darken_value">10%</span></label>
                    <input type="range" id="thumbnail_darken" min="0" max="100" value="10">
                </div>
                
                <div class="form-group">
                    <label for="intro_duration">ì¸íŠ¸ë¡œ ê¸¸ì´ (ì´ˆ)</label>
                    <input type="number" id="intro_duration" min="1" max="5" value="3">
                </div>
            </div>
            
            <!-- ê³ ê¸‰ ì„¤ì • -->
            <div class="settings-section">
                <h2>âš™ï¸ ê³ ê¸‰ ì„¤ì •</h2>
                
                <div class="form-group">
                    <label for="hardware_accel">í•˜ë“œì›¨ì–´ ê°€ì†</label>
                    <select id="hardware_accel" name="hardware_accel">
                        <option value="none">ì‚¬ìš© ì•ˆ í•¨</option>
                        <option value="nvidia">NVIDIA GPU</option>
                        <option value="amd">AMD GPU</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="threads">ìŠ¤ë ˆë“œ ìˆ˜</label>
                    <input type="number" id="threads" min="0" max="32" value="0">
                    <small style="color: #666;">0 = ìë™</small>
                </div>
                
                <div class="form-group">
                    <label for="temp_path">ì„ì‹œ íŒŒì¼ ê²½ë¡œ</label>
                    <input type="text" id="temp_path" value="/tmp">
                </div>
                
                <div class="form-group">
                    <label for="output_format">ì¶œë ¥ í˜•ì‹</label>
                    <select id="output_format" name="output_format">
                        <option value="mp4">MP4</option>
                        <option value="webm">WebM</option>
                        <option value="mkv">MKV</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="button-group">
            <button class="btn-load" onclick="loadSettings()">ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°</button>
            <button class="btn-save" onclick="saveSettings()">ì„¤ì • ì €ì¥</button>
            <button class="btn-reset" onclick="resetSettings()">ì´ˆê¸°í™”</button>
        </div>
    </div>
    
    <script>
        // Range input ê°’ í‘œì‹œ ì—…ë°ì´íŠ¸
        document.getElementById('tts_speed').addEventListener('input', function() {
            document.getElementById('speed_value').textContent = this.value + '%';
        });
        
        document.getElementById('tts_pitch').addEventListener('input', function() {
            document.getElementById('pitch_value').textContent = this.value + 'Hz';
        });
        
        document.getElementById('tts_volume').addEventListener('input', function() {
            document.getElementById('volume_value').textContent = this.value + '%';
        });
        
        document.getElementById('bg_music_volume').addEventListener('input', function() {
            document.getElementById('bg_music_value').textContent = this.value + '%';
        });
        
        document.getElementById('thumbnail_darken').addEventListener('input', function() {
            document.getElementById('darken_value').textContent = this.value + '%';
        });
        
        // Color input ë™ê¸°í™”
        document.getElementById('subtitle_color_english').addEventListener('input', function() {
            document.getElementById('subtitle_color_english_text').value = this.value;
        });
        
        document.getElementById('subtitle_color_korean').addEventListener('input', function() {
            document.getElementById('subtitle_color_korean_text').value = this.value;
        });
        
        function showMessage(text, type) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = 'message ' + type;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }
        
        async function loadSettings() {
            try {
                const response = await fetch('/api/settings');
                const settings = await response.json();
                
                // TTS ì„¤ì •
                document.getElementById('voice_korean').value = settings.tts.voice_korean;
                document.getElementById('voice_english').value = settings.tts.voice_english;
                document.getElementById('tts_speed').value = settings.tts.speed;
                document.getElementById('tts_pitch').value = settings.tts.pitch;
                document.getElementById('tts_volume').value = settings.tts.volume;
                
                // ë¹„ë””ì˜¤ ì„¤ì •
                document.getElementById('video_crf').value = settings.video.crf;
                document.getElementById('video_preset').value = settings.video.preset;
                document.getElementById('video_resolution').value = settings.video.resolution;
                document.getElementById('video_framerate').value = settings.video.framerate;
                
                // ìë§‰ ì„¤ì •
                document.getElementById('subtitle_font_english').value = settings.subtitle.font_english;
                document.getElementById('subtitle_size_english').value = settings.subtitle.size_english;
                document.getElementById('subtitle_color_english').value = settings.subtitle.color_english;
                document.getElementById('subtitle_color_english_text').value = settings.subtitle.color_english;
                document.getElementById('subtitle_size_korean').value = settings.subtitle.size_korean;
                document.getElementById('subtitle_color_korean').value = settings.subtitle.color_korean;
                document.getElementById('subtitle_color_korean_text').value = settings.subtitle.color_korean;
                document.getElementById('subtitle_border_width').value = settings.subtitle.border_width;
                
                // í…œí”Œë¦¿ ì„¤ì •
                document.getElementById('gap_duration').value = settings.template.gap_duration;
                document.getElementById('fade_effect').checked = settings.template.fade_effect;
                document.getElementById('show_title').checked = settings.template.show_title;
                document.getElementById('bg_music_volume').value = settings.template.background_music_volume;
                
                // ì‡¼ì¸  ì„¤ì •
                document.getElementById('shorts_aspect_ratio').value = settings.shorts.aspect_ratio;
                document.getElementById('thumbnail_darken').value = settings.shorts.thumbnail_darken;
                document.getElementById('intro_duration').value = settings.shorts.intro_duration;
                
                // ê³ ê¸‰ ì„¤ì •
                document.getElementById('hardware_accel').value = settings.advanced.hardware_accel;
                document.getElementById('threads').value = settings.advanced.threads;
                document.getElementById('temp_path').value = settings.advanced.temp_path;
                document.getElementById('output_format').value = settings.advanced.output_format;
                
                // Range ê°’ ì—…ë°ì´íŠ¸
                document.getElementById('speed_value').textContent = settings.tts.speed + '%';
                document.getElementById('pitch_value').textContent = settings.tts.pitch + 'Hz';
                document.getElementById('volume_value').textContent = settings.tts.volume + '%';
                document.getElementById('bg_music_value').textContent = settings.template.background_music_volume + '%';
                document.getElementById('darken_value').textContent = settings.shorts.thumbnail_darken + '%';
                
                showMessage('ì„¤ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                showMessage('ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ' + error.message, 'error');
            }
        }
        
        async function saveSettings() {
            const settings = {
                tts: {
                    voice_korean: document.getElementById('voice_korean').value,
                    voice_english: document.getElementById('voice_english').value,
                    speed: parseInt(document.getElementById('tts_speed').value),
                    pitch: parseInt(document.getElementById('tts_pitch').value),
                    volume: parseInt(document.getElementById('tts_volume').value)
                },
                video: {
                    crf: parseInt(document.getElementById('video_crf').value),
                    preset: document.getElementById('video_preset').value,
                    resolution: document.getElementById('video_resolution').value,
                    framerate: parseInt(document.getElementById('video_framerate').value)
                },
                subtitle: {
                    font_english: document.getElementById('subtitle_font_english').value,
                    font_korean: document.getElementById('subtitle_font_english').value,
                    size_english: parseInt(document.getElementById('subtitle_size_english').value),
                    size_korean: parseInt(document.getElementById('subtitle_size_korean').value),
                    color_english: document.getElementById('subtitle_color_english').value,
                    color_korean: document.getElementById('subtitle_color_korean').value,
                    border_width: parseInt(document.getElementById('subtitle_border_width').value),
                    border_color: "#000000",
                    position: "bottom",
                    margin_bottom: 300
                },
                template: {
                    gap_duration: parseFloat(document.getElementById('gap_duration').value),
                    fade_effect: document.getElementById('fade_effect').checked,
                    show_title: document.getElementById('show_title').checked,
                    background_music_volume: parseInt(document.getElementById('bg_music_volume').value)
                },
                shorts: {
                    aspect_ratio: document.getElementById('shorts_aspect_ratio').value,
                    thumbnail_darken: parseInt(document.getElementById('thumbnail_darken').value),
                    intro_duration: parseInt(document.getElementById('intro_duration').value)
                },
                advanced: {
                    hardware_accel: document.getElementById('hardware_accel').value,
                    threads: parseInt(document.getElementById('threads').value),
                    temp_path: document.getElementById('temp_path').value,
                    output_format: document.getElementById('output_format').value
                }
            };
            
            try {
                const response = await fetch('/api/settings', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settings)
                });
                
                if (response.ok) {
                    showMessage('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                } else {
                    throw new Error('ì„¤ì • ì €ì¥ ì‹¤íŒ¨');
                }
            } catch (error) {
                showMessage('ì„¤ì • ì €ì¥ ì‹¤íŒ¨: ' + error.message, 'error');
            }
        }
        
        async function resetSettings() {
            if (confirm('ëª¨ë“  ì„¤ì •ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    const response = await fetch('/api/settings/reset', {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        await loadSettings();
                        showMessage('ì„¤ì •ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    } else {
                        throw new Error('ì„¤ì • ì´ˆê¸°í™” ì‹¤íŒ¨');
                    }
                } catch (error) {
                    showMessage('ì„¤ì • ì´ˆê¸°í™” ì‹¤íŒ¨: ' + error.message, 'error');
                }
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
        window.addEventListener('DOMContentLoaded', loadSettings);
    </script>
</body>
</html>